{
  "experiment_name": "gemma3_3k_completion_preference_probes",
  "run_dir": "results/experiments/gemma3_3k_run2/pre_task_active_learning/completion_preference_gemma-3-27b_completion_canonical_seed0",
  "activations_path": "activations/gemma_3_27b/activations_prompt_last.npz",
  "modes": [
    "ridge",
    "bradley_terry"
  ],
  "created_at": "2026-02-09T16:02:47.729669",
  "n_tasks_in_experiment": 3000,
  "n_tasks_with_activations": 3000,
  "n_comparisons_in_experiment": 117435,
  "residualize_confounds": [
    "topic",
    "prompt_length"
  ],
  "probes": [
    {
      "id": "ridge_L31",
      "file": "probes/probe_ridge_L31.npy",
      "method": "ridge",
      "layer": 31,
      "cv_r2_mean": 0.4648507662921183,
      "cv_r2_std": 0.009540675380098139,
      "cv_mse_mean": 6.7854548814661655,
      "cv_mse_std": 0.28478853604309845,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7541857566964036,
      "n_samples": 3000,
      "train_test_gap": 0.28933499040428534,
      "cv_stability": 0.979475831664973,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9997875091818296,
          "val_r2_mean": -0.26382364465181996,
          "val_r2_std": 0.060200306694485596,
          "val_mse_mean": 16.01046772468951,
          "val_mse_std": 0.719685663392731
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9988189283064717,
          "val_r2_mean": -0.1971991408885844,
          "val_r2_std": 0.05186891373763019,
          "val_mse_mean": 15.165282629494254,
          "val_mse_std": 0.5799561255684317
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.990426815834486,
          "val_r2_mean": -0.03890117858119726,
          "val_r2_std": 0.037326867717212706,
          "val_mse_mean": 13.161356765867907,
          "val_mse_std": 0.4297359311262283
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9546883559237526,
          "val_r2_mean": 0.20329189356396826,
          "val_r2_std": 0.019029983358840603,
          "val_mse_mean": 10.095699294288897,
          "val_mse_std": 0.2956787630267125
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.8746040695368839,
          "val_r2_mean": 0.39063595458018796,
          "val_r2_std": 0.008253017274471362,
          "val_mse_mean": 7.724071563651455,
          "val_mse_std": 0.2517805465973842
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7541857566964036,
          "val_r2_mean": 0.4648507662921183,
          "val_r2_std": 0.009540675380098139,
          "val_mse_mean": 6.7854548814661655,
          "val_mse_std": 0.28478853604309845
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.6167929297601872,
          "val_r2_mean": 0.4494120177390932,
          "val_r2_std": 0.010063805490495407,
          "val_mse_mean": 6.982150131599239,
          "val_mse_std": 0.31494376399573
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.486679097560308,
          "val_r2_mean": 0.3666188853408258,
          "val_r2_std": 0.007992047956771204,
          "val_mse_mean": 8.030773198381727,
          "val_mse_std": 0.3188588385572098
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.3541417080922563,
          "val_r2_mean": 0.23005997143010806,
          "val_r2_std": 0.0073006903648345275,
          "val_mse_mean": 9.760784153164696,
          "val_mse_std": 0.3416051340861528
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.2158439484957017,
          "val_r2_mean": 0.1059898669802238,
          "val_r2_std": 0.004922710176768128,
          "val_mse_mean": 11.332472858209075,
          "val_mse_std": 0.35115995789481796
        }
      ]
    },
    {
      "id": "bt_L31",
      "file": "probes/probe_bt_L31.npy",
      "method": "bradley_terry",
      "layer": 31,
      "train_accuracy": 0.8531969941808613,
      "train_loss": 0.32559384021786425,
      "n_iterations": 2180,
      "n_pairs": 113247
    },
    {
      "id": "ridge_L43",
      "file": "probes/probe_ridge_L43.npy",
      "method": "ridge",
      "layer": 43,
      "cv_r2_mean": 0.4053217614710185,
      "cv_r2_std": 0.009770768600545746,
      "cv_mse_mean": 7.538372823194432,
      "cv_mse_std": 0.2660854927890795,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7420772568971173,
      "n_samples": 3000,
      "train_test_gap": 0.33675549542609884,
      "cv_stability": 0.9758937971583996,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9998232778513841,
          "val_r2_mean": -0.26118804651610655,
          "val_r2_std": 0.051633971920010326,
          "val_mse_mean": 15.974870869862787,
          "val_mse_std": 0.5440990936412857
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9992216050225978,
          "val_r2_mean": -0.21158218255452382,
          "val_r2_std": 0.05103113561097214,
          "val_mse_mean": 15.346073449326218,
          "val_mse_std": 0.5312682402318232
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.9932314888397378,
          "val_r2_mean": -0.08822646593483134,
          "val_r2_std": 0.04352050888735181,
          "val_mse_mean": 13.786237175212676,
          "val_mse_std": 0.5132688512908924
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9610282693015874,
          "val_r2_mean": 0.13266222252280577,
          "val_r2_std": 0.030592144575360268,
          "val_mse_mean": 10.990697039478947,
          "val_mse_std": 0.4265193127133502
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.8769093486690163,
          "val_r2_mean": 0.32329378243587364,
          "val_r2_std": 0.01864022263459721,
          "val_mse_mean": 8.575955200883879,
          "val_mse_std": 0.2999585928869051
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7420772568971173,
          "val_r2_mean": 0.4053217614710185,
          "val_r2_std": 0.009770768600545746,
          "val_mse_mean": 7.538372823194432,
          "val_mse_std": 0.2660854927890795
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.5871230519794488,
          "val_r2_mean": 0.39332363318495556,
          "val_r2_std": 0.008346658927198668,
          "val_mse_mean": 7.692047106993087,
          "val_mse_std": 0.3055211989575793
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.4410323045640033,
          "val_r2_mean": 0.30960902936257445,
          "val_r2_std": 0.012162188078350143,
          "val_mse_mean": 8.752951451195147,
          "val_mse_std": 0.3498279822181523
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.30141541931496807,
          "val_r2_mean": 0.18604229252544818,
          "val_r2_std": 0.011606437939392754,
          "val_mse_mean": 10.31832561750393,
          "val_mse_std": 0.3654865674661756
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.1752120219272425,
          "val_r2_mean": 0.08450747629753601,
          "val_r2_std": 0.006966673236615975,
          "val_mse_mean": 11.604404184606514,
          "val_mse_std": 0.3531891033627196
        }
      ]
    },
    {
      "id": "bt_L43",
      "file": "probes/probe_bt_L43.npy",
      "method": "bradley_terry",
      "layer": 43,
      "train_accuracy": 0.8540976802917517,
      "train_loss": 0.31743029141249385,
      "n_iterations": 3468,
      "n_pairs": 113247
    },
    {
      "id": "ridge_L55",
      "file": "probes/probe_ridge_L55.npy",
      "method": "ridge",
      "layer": 55,
      "cv_r2_mean": 0.3864892229162005,
      "cv_r2_std": 0.018462141282569962,
      "cv_mse_mean": 7.780645942642425,
      "cv_mse_std": 0.40431201854399523,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7595768520873571,
      "n_samples": 3000,
      "train_test_gap": 0.3730876291711566,
      "cv_stability": 0.9522311614836513,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9998680241862054,
          "val_r2_mean": -0.30369675420028497,
          "val_r2_std": 0.10192749865678188,
          "val_mse_mean": 16.510468111324496,
          "val_mse_std": 1.1974493936256818
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9994746241770108,
          "val_r2_mean": -0.2621522007184519,
          "val_r2_std": 0.101711116421236,
          "val_mse_mean": 15.98438667519729,
          "val_mse_std": 1.200902259782256
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.9954408174013006,
          "val_r2_mean": -0.15102320225325086,
          "val_r2_std": 0.09072273732443174,
          "val_mse_mean": 14.579004673134188,
          "val_mse_std": 1.092126825354033
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9698555398950669,
          "val_r2_mean": 0.0741289584066775,
          "val_r2_std": 0.06428623288387424,
          "val_mse_mean": 11.730962745806536,
          "val_mse_std": 0.8129084260296365
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.893757106046421,
          "val_r2_mean": 0.29044757112779573,
          "val_r2_std": 0.03335123204187309,
          "val_mse_mean": 8.994885794686551,
          "val_mse_std": 0.506824674622425
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7595768520873571,
          "val_r2_mean": 0.3864892229162005,
          "val_r2_std": 0.018462141282569962,
          "val_mse_mean": 7.780645942642425,
          "val_mse_std": 0.40431201854399523
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.5927561946981339,
          "val_r2_mean": 0.3781191336937922,
          "val_r2_std": 0.01356002108119258,
          "val_mse_mean": 7.88673731478666,
          "val_mse_std": 0.3793772555807125
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.43465234625278376,
          "val_r2_mean": 0.29555332152766833,
          "val_r2_std": 0.013922597953400746,
          "val_mse_mean": 8.93200209001843,
          "val_mse_std": 0.38514401896823697
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.28839129061921104,
          "val_r2_mean": 0.17583275317200672,
          "val_r2_std": 0.011719778860604373,
          "val_mse_mean": 10.448270564647398,
          "val_mse_std": 0.38371218509743377
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.16575775741598367,
          "val_r2_mean": 0.08059794588545899,
          "val_r2_std": 0.00680165092437853,
          "val_mse_mean": 11.65419145433128,
          "val_mse_std": 0.3612909116847237
        }
      ]
    },
    {
      "id": "bt_L55",
      "file": "probes/probe_bt_L55.npy",
      "method": "bradley_terry",
      "layer": 55,
      "train_accuracy": 0.8544773812992839,
      "train_loss": 0.316599278975155,
      "n_iterations": 3733,
      "n_pairs": 113247
    }
  ],
  "metadata_r2": 0.6213,
  "metadata_features": [
    "topic_content_generation",
    "topic_fiction",
    "topic_harmful_request",
    "topic_knowledge_qa",
    "topic_math",
    "topic_model_manipulation",
    "topic_other",
    "topic_persuasive_writing",
    "topic_security_legal",
    "topic_sensitive_creative",
    "topic_summarization",
    "prompt_length"
  ],
  "n_tasks_residualized": 3000,
  "n_tasks_dropped": 0
}