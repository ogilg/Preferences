{
  "experiment_name": "gemma3_3k_completion_preference_probes_both_resid",
  "run_dir": "results/experiments/gemma3_3k_run2/pre_task_active_learning/completion_preference_gemma-3-27b_completion_canonical_seed0",
  "activations_path": "activations/gemma_3_27b/activations_prompt_last.npz",
  "modes": [
    "ridge"
  ],
  "created_at": "2026-02-09T14:22:35.006541",
  "n_tasks_in_experiment": 3000,
  "n_tasks_with_activations": 3000,
  "n_comparisons_in_experiment": 0,
  "residualize_confounds": [
    "topic",
    "dataset",
    "prompt_length"
  ],
  "probes": [
    {
      "id": "ridge_L31",
      "file": "probes/probe_ridge_L31.npy",
      "method": "ridge",
      "layer": 31,
      "cv_r2_mean": 0.5206728294459779,
      "cv_r2_std": 0.01421086236579709,
      "cv_mse_mean": 5.441818625164155,
      "cv_mse_std": 0.18473619807164735,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7834363843596334,
      "n_samples": 3000,
      "train_test_gap": 0.26276355491365544,
      "cv_stability": 0.9727067333661547,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9997982785051812,
          "val_r2_mean": 0.03185044005784541,
          "val_r2_std": 0.03040220700627362,
          "val_mse_mean": 10.9875749628829,
          "val_mse_std": 0.2635652035222354
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9990207891527535,
          "val_r2_mean": 0.07638278596262726,
          "val_r2_std": 0.03085634783925698,
          "val_mse_mean": 10.481325154401873,
          "val_mse_std": 0.24443042814679625
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.9924247771941959,
          "val_r2_mean": 0.1866145915987446,
          "val_r2_std": 0.029457400244527122,
          "val_mse_mean": 9.228803993064707,
          "val_mse_std": 0.18372017219624062
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9635373385603753,
          "val_r2_mean": 0.35128391200411785,
          "val_r2_std": 0.024422514383360325,
          "val_mse_mean": 7.359606362064222,
          "val_mse_std": 0.12418220964934631
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.8939595010219626,
          "val_r2_mean": 0.4758168936286632,
          "val_r2_std": 0.017258226810748536,
          "val_mse_mean": 5.948359741762763,
          "val_mse_std": 0.12848134750258974
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7834363843596334,
          "val_r2_mean": 0.5206728294459779,
          "val_r2_std": 0.01421086236579709,
          "val_mse_mean": 5.441818625164155,
          "val_mse_std": 0.18473619807164735
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.6548733230151789,
          "val_r2_mean": 0.4936850137281724,
          "val_r2_std": 0.012635614230190401,
          "val_mse_mean": 5.750730154024248,
          "val_mse_std": 0.24309776905101568
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.5260924691069063,
          "val_r2_mean": 0.3942606525252636,
          "val_r2_std": 0.010581675684878236,
          "val_mse_mean": 6.882985848656839,
          "val_mse_std": 0.3367224821644233
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.3951512810378419,
          "val_r2_mean": 0.23547365493720518,
          "val_r2_std": 0.0071839939235103555,
          "val_mse_mean": 8.689109789707606,
          "val_mse_std": 0.446025482606312
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.25466714131968127,
          "val_r2_mean": 0.09584939895489239,
          "val_r2_std": 0.003143334201412833,
          "val_mse_mean": 10.275413880570222,
          "val_mse_std": 0.5077266176079394
        }
      ]
    },
    {
      "id": "ridge_L43",
      "file": "probes/probe_ridge_L43.npy",
      "method": "ridge",
      "layer": 43,
      "cv_r2_mean": 0.45309453138121114,
      "cv_r2_std": 0.01978566515594411,
      "cv_mse_mean": 6.205696124043183,
      "cv_mse_std": 0.14381363735976765,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7628567211693253,
      "n_samples": 3000,
      "train_test_gap": 0.3097621897881142,
      "cv_stability": 0.9563321475294287,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9998198014093994,
          "val_r2_mean": -0.12779794238170522,
          "val_r2_std": 0.04027153989352794,
          "val_mse_mean": 12.801342157762269,
          "val_mse_std": 0.4374146524776672
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9992625745039605,
          "val_r2_mean": -0.08261357329850214,
          "val_r2_std": 0.039341382531728294,
          "val_mse_mean": 12.28444053615812,
          "val_mse_std": 0.28924572310376856
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.9939291634319474,
          "val_r2_mean": 0.02403158838686379,
          "val_r2_std": 0.02983042262758934,
          "val_mse_mean": 11.075822257440922,
          "val_mse_std": 0.23227879578674868
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9650478888608638,
          "val_r2_mean": 0.2152152846585346,
          "val_r2_std": 0.02112362211662826,
          "val_mse_mean": 8.908669287614861,
          "val_mse_std": 0.25011552269323284
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.8880227716852651,
          "val_r2_mean": 0.38276826953594617,
          "val_r2_std": 0.02134939383542306,
          "val_mse_mean": 7.005067328792968,
          "val_mse_std": 0.199725215337113
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7628567211693253,
          "val_r2_mean": 0.45309453138121114,
          "val_r2_std": 0.01978566515594411,
          "val_mse_mean": 6.205696124043183,
          "val_mse_std": 0.14381363735976765
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.6190465610764112,
          "val_r2_mean": 0.4386565011408954,
          "val_r2_std": 0.01707968020502566,
          "val_mse_mean": 6.37231919775206,
          "val_mse_std": 0.20183025227046106
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.4852866888798099,
          "val_r2_mean": 0.3529013448295386,
          "val_r2_std": 0.01640754776878199,
          "val_mse_mean": 7.349792669548729,
          "val_mse_std": 0.3130576718219832
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.3653589760426233,
          "val_r2_mean": 0.2103674257641976,
          "val_r2_std": 0.01135925691334921,
          "val_mse_mean": 8.971603862761976,
          "val_mse_std": 0.4079707169373553
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.23850416531300928,
          "val_r2_mean": 0.0831940679002419,
          "val_r2_std": 0.005453758717592549,
          "val_mse_mean": 10.41776864914776,
          "val_mse_std": 0.48432145778429025
        }
      ]
    },
    {
      "id": "ridge_L55",
      "file": "probes/probe_ridge_L55.npy",
      "method": "ridge",
      "layer": 55,
      "cv_r2_mean": 0.4396962451642542,
      "cv_r2_std": 0.031324202797160236,
      "cv_mse_mean": 6.354234139726822,
      "cv_mse_std": 0.22384479720620132,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7805289364358862,
      "n_samples": 3000,
      "train_test_gap": 0.34083269127163196,
      "cv_stability": 0.9287594489729276,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9998477322985146,
          "val_r2_mean": -0.15082040629401564,
          "val_r2_std": 0.06179928059336332,
          "val_mse_mean": 13.05146265659145,
          "val_mse_std": 0.4214316834734418
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9994766305774999,
          "val_r2_mean": -0.10226068545756331,
          "val_r2_std": 0.058408933161140236,
          "val_mse_mean": 12.500813886802462,
          "val_mse_std": 0.3900944527567138
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.9959563490354019,
          "val_r2_mean": -0.007101358488537613,
          "val_r2_std": 0.059395143016979325,
          "val_mse_mean": 11.420140019789024,
          "val_mse_std": 0.4230910535888097
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9736864711226626,
          "val_r2_mean": 0.17767357223268393,
          "val_r2_std": 0.056267398362718234,
          "val_mse_mean": 9.322691634753484,
          "val_mse_std": 0.42644928557141887
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.9052286583242127,
          "val_r2_mean": 0.35724854848182636,
          "val_r2_std": 0.045280031591818176,
          "val_mse_mean": 7.285916055805851,
          "val_mse_std": 0.3380021032038318
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7805289364358862,
          "val_r2_mean": 0.4396962451642542,
          "val_r2_std": 0.031324202797160236,
          "val_mse_mean": 6.354234139726822,
          "val_mse_std": 0.22384479720620132
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.6267521870742591,
          "val_r2_mean": 0.4308514738287708,
          "val_r2_std": 0.02017639623794482,
          "val_mse_mean": 6.4604871886174235,
          "val_mse_std": 0.22250877675975456
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.48590149375930247,
          "val_r2_mean": 0.34620718007045886,
          "val_r2_std": 0.01748798566962423,
          "val_mse_mean": 7.426010048317107,
          "val_mse_std": 0.32632625926385994
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.35920926930375735,
          "val_r2_mean": 0.20381341333832914,
          "val_r2_std": 0.011351963920488796,
          "val_mse_mean": 9.046015935520582,
          "val_mse_std": 0.40965516005587366
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.22819680339421927,
          "val_r2_mean": 0.08070363699214708,
          "val_r2_std": 0.005407882191493401,
          "val_mse_mean": 10.445939057084656,
          "val_mse_std": 0.48261976470661083
        }
      ]
    }
  ],
  "metadata_r2": 0.6605,
  "metadata_features": [
    "dataset_bailbench",
    "dataset_competition_math",
    "dataset_stresstest",
    "dataset_wildchat",
    "topic_content_generation",
    "topic_fiction",
    "topic_harmful_request",
    "topic_knowledge_qa",
    "topic_math",
    "topic_other",
    "topic_persuasive_writing",
    "topic_summarization",
    "prompt_length"
  ],
  "n_tasks_residualized": 3000,
  "n_tasks_dropped": 0
}