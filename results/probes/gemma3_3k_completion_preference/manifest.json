{
  "experiment_name": "gemma3_3k_completion_preference_probes",
  "run_dir": "results/experiments/gemma3_3k_run2/pre_task_active_learning/completion_preference_gemma-3-27b_completion_canonical_seed0",
  "activations_path": "activations/gemma_3_27b/activations_prompt_last.npz",
  "modes": [
    "ridge"
  ],
  "created_at": "2026-02-09T14:23:28.947082",
  "n_tasks_in_experiment": 3000,
  "n_tasks_with_activations": 3000,
  "n_comparisons_in_experiment": 0,
  "residualize_confounds": [
    "topic",
    "prompt_length"
  ],
  "probes": [
    {
      "id": "ridge_L31",
      "file": "probes/probe_ridge_L31.npy",
      "method": "ridge",
      "layer": 31,
      "cv_r2_mean": 0.5262248447885721,
      "cv_r2_std": 0.006757393638174966,
      "cv_mse_mean": 6.71580538968893,
      "cv_mse_std": 0.3888374581183607,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7776318875669491,
      "n_samples": 3000,
      "train_test_gap": 0.251407042778377,
      "cv_stability": 0.9871587331844701,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9998284681602057,
          "val_r2_mean": -0.0004666808558502655,
          "val_r2_std": 0.030192110565371584,
          "val_mse_mean": 14.163945699920285,
          "val_mse_std": 0.5551994123124493
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9990458371606853,
          "val_r2_mean": 0.0448117830408334,
          "val_r2_std": 0.029971202362368304,
          "val_mse_mean": 13.523330141211932,
          "val_mse_std": 0.554494632335652
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.992154653043521,
          "val_r2_mean": 0.16221147482897266,
          "val_r2_std": 0.02318275662659274,
          "val_mse_mean": 11.863038338862765,
          "val_mse_std": 0.49691815117169597
        },
        {
          "alpha": 100.0,
          "train_r2": 0.961417087090387,
          "val_r2_mean": 0.3411248327942954,
          "val_r2_std": 0.016593511501444006,
          "val_mse_mean": 9.331123611813581,
          "val_mse_std": 0.4096780296069393
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.8886230929961573,
          "val_r2_mean": 0.47696589891967267,
          "val_r2_std": 0.010183759677661507,
          "val_mse_mean": 7.409997360056783,
          "val_mse_std": 0.3635688709077641
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7776318875669491,
          "val_r2_mean": 0.5262248447885721,
          "val_r2_std": 0.006757393638174966,
          "val_mse_mean": 6.71580538968893,
          "val_mse_std": 0.3888374581183607
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.6532585996483804,
          "val_r2_mean": 0.5049172788695138,
          "val_r2_std": 0.010897091010477818,
          "val_mse_mean": 7.019966567213034,
          "val_mse_std": 0.4557661998931974
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.5315399621828267,
          "val_r2_mean": 0.4195157472246204,
          "val_r2_std": 0.01565932723847721,
          "val_mse_mean": 8.231163259191323,
          "val_mse_std": 0.5517313856894603
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.3992975065212298,
          "val_r2_mean": 0.2738003385819484,
          "val_r2_std": 0.012228202066487713,
          "val_mse_mean": 10.297376476637334,
          "val_mse_std": 0.656955886041758
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.25051090544620885,
          "val_r2_mean": 0.13180342802998107,
          "val_r2_std": 0.006710918707886036,
          "val_mse_mean": 12.310305330595575,
          "val_mse_std": 0.7543645775466903
        }
      ]
    },
    {
      "id": "ridge_L43",
      "file": "probes/probe_ridge_L43.npy",
      "method": "ridge",
      "layer": 43,
      "cv_r2_mean": 0.4621599207456656,
      "cv_r2_std": 0.016385241099915702,
      "cv_mse_mean": 7.618598911782226,
      "cv_mse_std": 0.38717314218883514,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7655671154826322,
      "n_samples": 3000,
      "train_test_gap": 0.30340719473696665,
      "cv_stability": 0.9645463824082067,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9998545181811124,
          "val_r2_mean": -0.13387022787983144,
          "val_r2_std": 0.0768585879228495,
          "val_mse_mean": 16.015236642364243,
          "val_mse_std": 0.3527604761346209
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9993240482692601,
          "val_r2_mean": -0.09246634594076322,
          "val_r2_std": 0.07639652014184027,
          "val_mse_mean": 15.426492004824315,
          "val_mse_std": 0.24606810750764557
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.9939995833658172,
          "val_r2_mean": 0.016713128278699575,
          "val_r2_std": 0.06104977993168677,
          "val_mse_mean": 13.89113724216131,
          "val_mse_std": 0.1727646260463855
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9650160734039299,
          "val_r2_mean": 0.2162391591119576,
          "val_r2_std": 0.03624801924862927,
          "val_mse_mean": 11.084558363019934,
          "val_mse_std": 0.29237039963016176
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.888789824413616,
          "val_r2_mean": 0.38976762071032767,
          "val_r2_std": 0.02108487902884232,
          "val_mse_mean": 8.639038308400325,
          "val_mse_std": 0.3622438171678954
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7655671154826322,
          "val_r2_mean": 0.4621599207456656,
          "val_r2_std": 0.016385241099915702,
          "val_mse_mean": 7.618598911782226,
          "val_mse_std": 0.38717314218883514
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.6234205506477948,
          "val_r2_mean": 0.4508294460048914,
          "val_r2_std": 0.017498571192570256,
          "val_mse_mean": 7.782302774847816,
          "val_mse_std": 0.4569251066078362
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.48999169163972245,
          "val_r2_mean": 0.37348156825431944,
          "val_r2_std": 0.021380766773923466,
          "val_mse_mean": 8.880105085548887,
          "val_mse_std": 0.5596740418061543
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.360947825969693,
          "val_r2_mean": 0.24354644724356814,
          "val_r2_std": 0.018192367469897244,
          "val_mse_mean": 10.722702289372489,
          "val_mse_std": 0.6458964611256889
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.2267280184561796,
          "val_r2_mean": 0.11716297804392413,
          "val_r2_std": 0.010306859257791595,
          "val_mse_mean": 12.515619315264969,
          "val_mse_std": 0.7355303937451196
        }
      ]
    },
    {
      "id": "ridge_L55",
      "file": "probes/probe_ridge_L55.npy",
      "method": "ridge",
      "layer": 55,
      "cv_r2_mean": 0.4551666980064826,
      "cv_r2_std": 0.01224651075923487,
      "cv_mse_mean": 7.720379217685005,
      "cv_mse_std": 0.41401125047660803,
      "best_alpha": 2154.4346900318824,
      "train_r2": 0.7909123670001221,
      "n_samples": 3000,
      "train_test_gap": 0.33574566899363956,
      "cv_stability": 0.9730944491102249,
      "alpha_sweep": [
        {
          "alpha": 1.0,
          "train_r2": 0.9998801924806247,
          "val_r2_mean": -0.10188067573801915,
          "val_r2_std": 0.05277656810914502,
          "val_mse_mean": 15.587921128118253,
          "val_mse_std": 0.5609970293743924
        },
        {
          "alpha": 4.641588833612778,
          "train_r2": 0.9995468834199249,
          "val_r2_mean": -0.06011605267631652,
          "val_r2_std": 0.05681954156859075,
          "val_mse_mean": 14.99112418312888,
          "val_mse_std": 0.4903546262325859
        },
        {
          "alpha": 21.544346900318832,
          "train_r2": 0.9962599328390513,
          "val_r2_mean": 0.029115842369934364,
          "val_r2_std": 0.05335732244202277,
          "val_mse_mean": 13.729108753469896,
          "val_mse_std": 0.47243044145256674
        },
        {
          "alpha": 100.0,
          "train_r2": 0.9755477263724838,
          "val_r2_mean": 0.20392304617670906,
          "val_r2_std": 0.042208273686210045,
          "val_mse_mean": 11.261042785983241,
          "val_mse_std": 0.4582943236526315
        },
        {
          "alpha": 464.15888336127773,
          "train_r2": 0.9111365827168574,
          "val_r2_mean": 0.3753500689100725,
          "val_r2_std": 0.0255660255475764,
          "val_mse_mean": 8.842998105875514,
          "val_mse_std": 0.4074338443916791
        },
        {
          "alpha": 2154.4346900318824,
          "train_r2": 0.7909123670001221,
          "val_r2_mean": 0.4551666980064826,
          "val_r2_std": 0.01224651075923487,
          "val_mse_mean": 7.720379217685005,
          "val_mse_std": 0.41401125047660803
        },
        {
          "alpha": 10000.0,
          "train_r2": 0.6381185707554202,
          "val_r2_mean": 0.4480692148084396,
          "val_r2_std": 0.014906960121301672,
          "val_mse_mean": 7.8247573446355165,
          "val_mse_std": 0.4968769030672526
        },
        {
          "alpha": 46415.888336127726,
          "train_r2": 0.4953746969343503,
          "val_r2_mean": 0.37100242413526613,
          "val_r2_std": 0.021922997965008385,
          "val_mse_mean": 8.917643126692818,
          "val_mse_std": 0.6022381779705082
        },
        {
          "alpha": 215443.46900318822,
          "train_r2": 0.35965841601669724,
          "val_r2_mean": 0.23943392157151716,
          "val_r2_std": 0.018057310892709205,
          "val_mse_mean": 10.782014930166017,
          "val_mse_std": 0.664931980148145
        },
        {
          "alpha": 1000000.0,
          "train_r2": 0.22780910478882935,
          "val_r2_mean": 0.11415641517979239,
          "val_r2_std": 0.010129735632950157,
          "val_mse_mean": 12.558468843363501,
          "val_mse_std": 0.7412718656765226
        }
      ]
    }
  ],
  "metadata_r2": 0.5763,
  "metadata_features": [
    "topic_content_generation",
    "topic_fiction",
    "topic_harmful_request",
    "topic_knowledge_qa",
    "topic_math",
    "topic_other",
    "topic_persuasive_writing",
    "topic_summarization",
    "prompt_length"
  ],
  "n_tasks_residualized": 3000,
  "n_tasks_dropped": 0
}